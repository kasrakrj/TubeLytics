@*
* This template displays the results of a search query for YouTube video descriptions.
*
* Inputs:
* - List of video descriptions matching the search query.
* - Sentiment analysis results or summary statistics for each description.
*
* Expected Outcome:
* - Renders a list of search results with individual video descriptions and sentiment scores.
* - Allows users to see an overview of relevant videos and their sentiment alignment.
*@

@import java.util.Collections
@import scala.jdk.CollectionConverters._
@(searchHistory: java.util.Map[String, java.util.List[entities.Video]], overallSentiment: String, individualSentiments: Map[String, String], keyword: String)

@main("YT Lytics") {
<style>
    /* Basic reset and font */
    body, html {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        background-color: #f0f0f5;
        color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        min-height: 100vh;
    }

    /* Welcome title */
    h1 {
        font-size: 2.5em;
        margin: 20px 0;
        color: #333;
        text-align: center;
    }

    /* SearchResult form */
    form {
        display: flex;
        align-items: center;
        margin-bottom: 40px;
    }
    input[type="text"] {
        padding: 10px 15px;
        font-size: 1em;
        border: 1px solid #ccc;
        border-radius: 5px 0 0 5px;
        outline: none;
        width: 300px;
    }
    button {
        padding: 10px 20px;
        background-color: #d32f2f;
        border: none;
        color: #fff;
        font-weight: bold;
        border-radius: 0 5px 5px 0;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }
    button:hover {
        background-color: #b71c1c; /* Hover */
    }

    /* SearchResult results */
    h1 + h1 {
        margin-top: 20px;
        font-size: 1.5em;
        color: #666;
        text-align: center;
    }

    /* Sentiment display */
    .sentiment {
        font-size: 1.2em;
        color: #555;
        text-align: center;
        margin-bottom: 20px;
    }

    /* SearchResult results list */
    ul {
        list-style-type: none;
        padding: 0;
        width: 80%;
        max-width: 1000px;
        margin: 0 auto;
    }
    li {
        background-color: #fff; /* White background for each item */
        margin: 15px 0;
        padding: 20px;
        border-radius: 10px;
        display: flex;
        align-items: flex-start;
        color: #333;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }
    li img {
        width: 120px;
        height: 80px;
        border-radius: 8px;
        margin-right: 20px;
    }
    li h3 {
        margin: 0;
        font-size: 1.2em;
        color: #333; /* Standard dark text color */
    }
    li a {
        text-decoration: none;
        color: inherit;
    }
    li p {
        margin: 5px 0;
        font-size: 0.9em;
    }
    li p strong {
        color: #444;
    }

    #new-videos-section {
        width: 80%;
        max-width: 1000px;
        margin: 0 auto 20px auto;
    }

    #new-videos-section h2 {
        font-size: 1.5em;
        color: #d32f2f;
        text-align: center;
        margin-bottom: 10px;
    }

    #separator {
        width: 80%;
        max-width: 1000px;
        margin: 20px auto;
        border-bottom: 2px solid #ccc;
    }

    /* Adjust existing ul styling */
    ul.video-list {
        list-style-type: none;
        padding: 0;
        width: 100%;
        margin: 0 auto;
    }

    #new-videos-section .video-item {
        background-color: #e3f2fd; /* Light blue background for new videos */
    }

    #new-videos-section h2 {
        color: #1976d2; /* Darker blue color for the header */
    }

    .new-video-item {
        background-color: #e3f2fd; /* Light blue background */
    }




</style>

<h1>YT Lytics - Search Results</h1>
<div id="status">Connecting to WebSocket...</div>
<form action="/search" method="GET">
    <input type="text" name="keyword" placeholder="Enter search keywords">
    <button type="submit">Search</button>
</form>

<script type="text/javascript">
        var searchKeywords = @Html(play.libs.Json.stringify(play.libs.Json.toJson(searchHistory.keySet().asScala)));



</script>

<!--<h2>Search Results for '@keyword'</h2>-->
<!--<div class="sentiment">-->
<!--    Sentiment for '@keyword': @individualSentiments.getOrElse(keyword, "N/A")-->
<!--</div>-->

<!--<div>-->
<!--    <a href="@routes.YoutubeController.wordStats(keyword)">Search Stats</a>-->
<!--</div>-->

<!-- Initial Search Results Section -->
@for((key, videos) <- searchHistory.asScala.toSeq.reverse) {
@defining(key.replaceAll("[^a-zA-Z0-9]", "_")) { safeKey =>
<h2>Search Results for '@key'</h2>
<div class="sentiment">
    Sentiment for '@key': @individualSentiments.getOrElse(key, "N/A")
</div>

<div>
    <a href="@routes.YoutubeController.wordStats(key)">Search Stats</a>
</div>

<!-- New Videos Section for this keyword -->
<div class="new-videos-section" id="new-videos-section-@safeKey">
    <!--    <h3>New Videos for '@key'</h3>-->
    <ul class="new-video-list" id="new-video-list-@safeKey">
        <!-- New videos will be appended here via JavaScript -->
    </ul>
</div>

<ul class="video-list">
    @for(video <- videos.asScala) {
    <li class="video-item">
        <img src="@video.getThumbnailUrl()" alt="Thumbnail">
        <div>
            <h3>
                <a href="https://www.youtube.com/watch?v=@video.getVideoId()" target="_blank">@video.getTitle()</a>
            </h3>
            <p>@video.getDescription()</p>
            <small>
                Channel:
                <a href="@routes.YoutubeController.channelProfile(video.getChannelId())">@video.getChannelTitle()</a>
            </small>
            <p><a href="@routes.YoutubeController.tags(video.getVideoId())">Tags</a></p>
        </div>
    </li>
    }
</ul>
<hr/>
}
}


<!-- Include the updated JavaScript file -->
<!--<script src="@routes.Assets.versioned("javascripts/main.js")"></script>-->
}